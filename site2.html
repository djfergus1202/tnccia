<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aether: Interactive Career & Study Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <style>
        :root {
            --bg-main: #F4F4F5;
            --bg-alt: #FFFFFF;
            --text-primary: #1F2937;
            --text-secondary: #4B5563;
            --accent-primary: #DC2626; /* Fusion Red */
            --accent-secondary: #B91C1C;
            --border-color: #E5E7EB;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-main); color: var(--text-primary); }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        .nav-item { transition: all 0.2s ease-in-out; border-bottom: 3px solid transparent; }
        .nav-item.active { border-bottom-color: var(--accent-primary); color: var(--accent-primary); }
        .nav-item:not(.active):hover { color: var(--accent-primary); }
        .content-section { display: none; }
        .content-section.active { display: block; }
        #career-path-canvas { 
            background-color: #F9FAFB; 
            background-image: 
                linear-gradient(var(--border-color) 1px, transparent 1px), 
                linear-gradient(to right, var(--border-color) 1px, #F9FAFB 1px); 
            background-size: 25px 25px;
            cursor: grab;
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
        }
        #career-path-canvas:active { cursor: grabbing; }
        .chart-container { position: relative; margin: auto; height: 50vh; width: 100%; max-width: 800px; max-height: 500px; }
        .feed-card-icon { width: 40px; height: 40px; flex-shrink: 0; }
        .drag-drop-zone { border: 2px dashed var(--border-color); border-radius: 0.5rem; padding: 1rem; text-align: center; cursor: pointer; transition: background-color 0.2s; }
        .drag-drop-zone.drag-over { background: #fee2e2; border-color: var(--accent-primary); }
        .required { color: var(--accent-primary); }
        .disclaimer { font-size: 0.8em; color: #555; margin-top: 8px; }
        .timeline-container { max-height: 400px; overflow-y: auto; }
        .timeline-avatar { width: 40px; height: 40px; border-radius: 50%; margin-right: 12px; object-fit: cover; }
    </style>
</head>
<body class="antialiased">

    <div id="registration-page" class="flex items-center justify-center min-h-screen bg-gray-100">
        <div class="text-center p-8 bg-white rounded-xl shadow-2xl max-w-lg mx-auto w-full">
            <h1 class="text-5xl font-black text-red-600 mb-4">Aether</h1>
            <p class="text-xl text-text-secondary mb-8">Create your profile to begin your integrated career and learning journey.</p>
            <form id="regForm" class="text-left" novalidate>
                 <div class="space-y-4">
                    <div>
                        <label for="fullName" class="block text-sm font-medium text-gray-700">Full Name<span class="required">*</span></label>
                        <input type="text" id="fullName" name="fullName" required class="mt-1 w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Email<span class="required">*</span></label>
                        <input type="email" id="email" name="email" required class="mt-1 w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div>
                        <label for="headline" class="block text-sm font-medium text-gray-700">Headline</label>
                        <input type="text" id="headline" name="headline" placeholder="e.g. Aspiring AI Researcher" class="mt-1 w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    <div>
                        <label for="bioReg" class="block text-sm font-medium text-gray-700">Bio</label>
                        <textarea id="bioReg" name="bioReg" rows="3" placeholder="Tell us about your goals and interests..." class="mt-1 w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500"></textarea>
                    </div>
                    <div>
                        <label for="avatarReg" class="block text-sm font-medium text-gray-700">Avatar URL</label>
                        <input type="url" id="avatarReg" name="avatarReg" placeholder="Link to your photo" class="mt-1 w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                </div>
                <button type="submit" class="mt-6 w-full px-6 py-3 bg-red-600 text-white font-bold rounded-lg hover:bg-red-700 transition-colors">Create Profile & Enter</button>
                <p class="text-center mt-4 text-sm text-gray-600">Already have an account? <a href="#" id="show-signin" class="font-medium text-red-600 hover:text-red-500">Sign In</a></p>
                <p class="disclaimer">By signing up you agree to be a part of this research study on optimizing student career achievement for better career and economic outcomes for the student. We maintain the claim that the data will solely be used for research purposes and de-identified before use in analysis.</p>
            </form>
        </div>
    </div>

    <div id="main-app" class="hidden">
        <nav class="bg-white shadow-md fixed w-full z-20">
            <div class="container mx-auto px-4 py-3 flex items-center justify-between">
                <div class="flex items-center space-x-8">
                    <span class="text-red-600 font-black text-2xl">Aether</span>
                    <div id="main-nav" class="hidden md:flex items-center space-x-6">
                        <button data-target="dashboard" class="nav-item font-semibold text-gray-600 active">Dashboard</button>
                        <button data-target="strategy" class="nav-item font-semibold text-gray-600">My Strategy</button>
                        <button data-target="canvas" class="nav-item font-semibold text-gray-600">Career Path</button>
                        <button data-target="learning" class="nav-item font-semibold text-gray-600">Learning Hub</button>
                        <button data-target="collaboration" class="nav-item font-semibold text-gray-600">Collaborate</button>
                        <button data-target="admin" class="nav-item font-semibold text-gray-600">Admin</button>
                    </div>
                </div>
                <div class="flex-1 mx-6 max-w-lg">
                    <input type="search" id="search-bar" placeholder="What is your dream job in an ideal world?" class="w-full px-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500 bg-gray-50"/>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="search-btn" title="Search" class="p-2 rounded-full hover:bg-gray-100">
                        <svg class="w-6 h-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" /></svg>
                    </button>
                    <button data-target="profile" id="profile-nav-btn" title="My Profile" class="nav-item p-2 rounded-full hover:bg-gray-100">
                        <img id="nav-avatar" src="https://i.pravatar.cc/32" alt="Profile" class="w-8 h-8 rounded-full"/>
                    </button>
                    <button id="sign-out-btn" title="Sign Out" class="p-2 rounded-full hover:bg-gray-100">
                        <svg class="w-6 h-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9" /></svg>
                    </button>
                </div>
            </div>
        </nav>

        <main class="pt-20">
            <div class="container mx-auto px-4 py-6">
                <section id="dashboard" class="content-section active">
                     <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2 space-y-8">
                            <section>
                                <h2 class="text-xl font-bold mb-3 text-text-primary">Strategy Feed</h2>
                                <div id="strategy-feed" class="space-y-6"></div>
                            </section>
                            <section role="region" aria-labelledby="podcastTitle">
                                <div class="bg-white p-6 rounded-xl border shadow-sm">
                                    <h2 id="podcastTitle" class="text-xl font-bold mb-4">üéôÔ∏è Podcast Hub</h2>
                                    <div class="flex gap-2 mb-4">
                                        <input id="feedUrl" type="url" placeholder="Enter podcast RSS feed URL..." class="w-full p-2 border border-border-color rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
                                        <button id="fetchFeed" class="px-4 py-2 bg-accent-primary text-white font-bold rounded-lg hover:bg-accent-secondary flex-shrink-0">Load</button>
                                    </div>
                                    <ul id="episodeFeed" class="space-y-4 max-h-64 overflow-y-auto"></ul>
                                </div>
                            </section>
                        </div>
                        <aside class="space-y-8">
                            <section role="region" aria-labelledby="timelineTitle">
                                 <h2 id="timelineTitle" class="text-xl font-bold text-text-primary mb-3">‚è≥ Connections Timeline</h2>
                                 <div class="bg-white rounded-lg shadow p-4 timeline-container">
                                    <ul id="timelineList" class="space-y-3"></ul>
                                 </div>
                            </section>
                            <div>
                                <h2 class="text-xl font-bold text-text-primary mb-3">Trending Career Paths</h2>
                                <div class="carousel flex space-x-4 overflow-x-auto pb-2">
                                    <div class="min-w-[140px] h-[210px] bg-gray-200 rounded-lg flex-shrink-0 overflow-hidden relative"><img src="https://source.unsplash.com/featured/140x210?ai" alt="AI Specialist" class="w-full h-full object-cover"/><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div><p class="absolute bottom-2 left-2 text-white font-bold">AI Specialist</p></div>
                                    <div class="min-w-[140px] h-[210px] bg-gray-200 rounded-lg flex-shrink-0 overflow-hidden relative"><img src="https://source.unsplash.com/featured/140x210?biotech" alt="Biotech Researcher" class="w-full h-full object-cover"/><div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div><p class="absolute bottom-2 left-2 text-white font-bold">Biotech Researcher</p></div>
                                </div>
                            </div>
                        </aside>
                    </div>
                </section>
                
                <section id="strategy" class="content-section">
                    <h2 class="text-3xl font-bold mb-2">My Strategy</h2>
                    <p class="text-lg text-text-secondary mb-6">Define your goals, skills, and study plans.</p>
                    <div class="space-y-4" id="strategy-accordions"></div>
                </section>

                <section id="canvas" class="content-section">
                    <h2 class="text-3xl font-bold mb-2">My Career Path</h2>
                    <p class="text-lg text-text-secondary mb-4 max-w-4xl">Visually plot your professional journey. Add goals and drag them to build your map.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="md:col-span-1 bg-white p-4 rounded-lg border shadow-sm">
                            <h3 class="font-bold text-lg mb-4">Goal Controls</h3>
                            <form id="add-node-form" class="space-y-4">
                                <div>
                                    <label for="node-title" class="block text-sm font-medium text-gray-700">Goal Title</label>
                                    <input type="text" id="node-title" class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm" required>
                                </div>
                                <div>
                                    <label for="node-type" class="block text-sm font-medium text-gray-700">Goal Type</label>
                                    <select id="node-type" class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm">
                                        <option value="rock">Major Goal</option>
                                        <option value="pebble">Milestone</option>
                                        <option value="study">Study Topic</option>
                                    </select>
                                </div>
                                <button type="submit" class="w-full px-4 py-2 bg-accent-primary text-white font-bold rounded-lg hover:bg-accent-secondary">Add to Map</button>
                            </form>
                            <div class="mt-6 pt-4 border-t">
                                <h4 class="font-semibold text-sm mb-2">Legend</h4>
                                <ul class="text-sm space-y-1">
                                    <li class="flex items-center"><span class="w-3 h-3 rounded-full mr-2" style="background-color: #DC2626;"></span>Major Goal</li>
                                    <li class="flex items-center"><span class="w-3 h-3 rounded-full mr-2" style="background-color: #3B82F6;"></span>Milestone</li>
                                    <li class="flex items-center"><span class="w-3 h-3 rounded-full mr-2" style="background-color: #10B981;"></span>Study Topic</li>
                                </ul>
                            </div>
                        </div>
                        <div class="md:col-span-3">
                            <div id="canvas-container" class="w-full h-[65vh] shadow-lg">
                                <canvas id="career-path-canvas"></canvas>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section id="learning" class="content-section">
                    </section>

                <section id="collaboration" class="content-section">
                    </section>
                
                <section id="admin" class="content-section">
                    </section>

                <section id="profile" class="content-section">
                    </section>
            </div>
        </main>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', () => {

    const ADMIN_PIN = '373202';

    // Central Data Store
    const appData = {
        feedItems: [{ type: 'ai-opportunity', content: "<strong>AI Opportunity:</strong> A new 'Computational Neuroscience' position just opened on Indeed. Its requirements are a 90% match with your skills." },{ type: 'node-add', content: "You added a new goal: 'Become a Robotics Engineer'." }],
        projects: JSON.parse(localStorage.getItem('aetherProjects') || '[]'),
        canvasNodes: JSON.parse(localStorage.getItem('aetherCanvasNodes')) || [
            { id: 'n1', type: 'rock', title: 'Become a Robotics Engineer', x: 50, y: 150 },
            { id: 'n2', type: 'pebble', title: 'Master Python for Robotics', x: 350, y: 50 },
            { id: 'n3', type: 'study', title: 'Complete CS50 Course', x: 350, y: 250 }
        ],
        canvasConnections: JSON.parse(localStorage.getItem('aetherCanvasConnections')) || [ 
            { from: 'n1', to: 'n2' }, 
            { from: 'n1', to: 'n3' } 
        ]
    };

    const mainApp = document.getElementById('main-app');
    const landingPage = document.getElementById('registration-page');
    // ... (other element selectors)

    // --- Authentication & Initialization (simplified for brevity) ---
    const storedUser = localStorage.getItem('aetherCurrentUser');
    if (storedUser) {
        showApp(JSON.parse(storedUser));
    } else {
        landingPage.style.display = 'flex';
    }

    function showApp(userData) {
        landingPage.style.display = 'none';
        mainApp.style.display = 'block';
        initializeMainApp(userData);
    }
    
    // Mock registration form submit
    document.getElementById('regForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const userData = { fullName: document.getElementById('fullName').value };
        localStorage.setItem('aetherCurrentUser', JSON.stringify(userData));
        showApp(userData);
    });


    function initializeMainApp(userData) {
        document.getElementById('nav-avatar').src = `https://i.pravatar.cc/32?u=${userData.fullName}`;
        
        const nav = document.getElementById('main-nav');
        const profileNavBtn = document.getElementById('profile-nav-btn');
        const sections = document.querySelectorAll('.content-section');
        
        function navigateTo(targetId) {
            nav.querySelectorAll('button').forEach(btn => btn.classList.toggle('active', btn.dataset.target === targetId));
            profileNavBtn.classList.toggle('active', 'profile' === targetId);
            sections.forEach(section => section.classList.toggle('active', section.id === targetId));
            
            if (targetId === 'canvas') initCareerMap();
            // ... (other initializers)
        }

        nav.addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if (button && button.dataset.target) {
                navigateTo(button.dataset.target);
            }
        });
        
        // --- Career Path Canvas ---
        let careerMapInitialized = false;
        function initCareerMap() {
            if (careerMapInitialized) return;
            careerMapInitialized = true;
            
            const canvas = document.getElementById('career-path-canvas');
            const container = document.getElementById('canvas-container');
            const ctx = canvas.getContext('2d');
            
            let isDragging = false;
            let selectedNode = null;
            let dragOffsetX, dragOffsetY;

            const nodeWidth = 180;
            const nodeHeight = 50;
            const nodeColors = {
                rock: '#DC2626', // Major Goal
                pebble: '#3B82F6', // Milestone
                study: '#10B981', // Study Topic
                text: '#FFFFFF'
            };

            function resizeCanvas() {
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                drawMap();
            }

            function drawMap() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Draw connections
                ctx.strokeStyle = '#9CA3AF';
                ctx.lineWidth = 2;
                appData.canvasConnections.forEach(conn => {
                    const fromNode = appData.canvasNodes.find(n => n.id === conn.from);
                    const toNode = appData.canvasNodes.find(n => n.id === conn.to);
                    if (fromNode && toNode) {
                        ctx.beginPath();
                        ctx.moveTo(fromNode.x + nodeWidth / 2, fromNode.y + nodeHeight / 2);
                        ctx.lineTo(toNode.x + nodeWidth / 2, toNode.y + nodeHeight / 2);
                        ctx.stroke();
                    }
                });

                // Draw nodes
                appData.canvasNodes.forEach(node => {
                    ctx.fillStyle = nodeColors[node.type] || '#6B7280';
                    ctx.roundRect(node.x, node.y, nodeWidth, nodeHeight, 8);
                    ctx.fill();
                    
                    ctx.fillStyle = nodeColors.text;
                    ctx.font = '14px "Inter", sans-serif';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(node.title, node.x + nodeWidth / 2, node.y + nodeHeight / 2, nodeWidth - 20);
                });
            }
            
            // --- Canvas Interactivity ---
            canvas.addEventListener('pointerdown', (e) => {
                const rect = canvas.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                const mouseY = e.clientY - rect.top;

                // Find node under cursor (iterate in reverse to select top-most node)
                for (let i = appData.canvasNodes.length - 1; i >= 0; i--) {
                    const node = appData.canvasNodes[i];
                    if (mouseX >= node.x && mouseX <= node.x + nodeWidth &&
                        mouseY >= node.y && mouseY <= node.y + nodeHeight) {
                        
                        selectedNode = node;
                        isDragging = true;
                        dragOffsetX = mouseX - node.x;
                        dragOffsetY = mouseY - node.y;
                        canvas.style.cursor = 'grabbing';
                        return;
                    }
                }
            });

            canvas.addEventListener('pointermove', (e) => {
                if (!isDragging || !selectedNode) return;
                
                const rect = canvas.getBoundingClientRect();
                selectedNode.x = e.clientX - rect.left - dragOffsetX;
                selectedNode.y = e.clientY - rect.top - dragOffsetY;
                
                drawMap();
            });

            canvas.addEventListener('pointerup', () => {
                if (isDragging) {
                    localStorage.setItem('aetherCanvasNodes', JSON.stringify(appData.canvasNodes));
                }
                isDragging = false;
                selectedNode = null;
                canvas.style.cursor = 'grab';
            });
            
            canvas.addEventListener('pointerleave', () => {
                if (isDragging) {
                    localStorage.setItem('aetherCanvasNodes', JSON.stringify(appData.canvasNodes));
                }
                isDragging = false;
                selectedNode = null;
                canvas.style.cursor = 'grab';
            });

            // --- Form to Add Nodes ---
            document.getElementById('add-node-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const titleInput = document.getElementById('node-title');
                const typeSelect = document.getElementById('node-type');
                
                const newNode = {
                    id: `node-${Date.now()}`,
                    title: titleInput.value,
                    type: typeSelect.value,
                    x: 20,
                    y: 20
                };
                
                appData.canvasNodes.push(newNode);
                localStorage.setItem('aetherCanvasNodes', JSON.stringify(appData.canvasNodes));
                drawMap();
                
                titleInput.value = '';
            });


            // Initial setup
            // Add roundRect to canvas context prototype if it doesn't exist
            if (!CanvasRenderingContext2D.prototype.roundRect) {
                CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
                    this.beginPath();
                    this.moveTo(x + r, y);
                    this.arcTo(x + w, y, x + w, y + h, r);
                    this.arcTo(x + w, y + h, x, y + h, r);
                    this.arcTo(x, y + h, x, y, r);
                    this.arcTo(x, y, x + w, y, r);
                    this.closePath();
                }
            }
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();
        }

        // --- Initial Renders ---
        navigateTo('dashboard');
    }
});
</script>
</body>
</html>
